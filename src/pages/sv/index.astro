---
import FormattedDate from '../../components/FormattedDate.astro';
import FormattedDateNews from '../../components/FormattedDateNews.astro';
import Body from '../../components/Body.astro';
import { getTranslations } from '../../utils/getTranslations';
import { getSortedEvents } from '../../utils/getSortedEvents';
import { getSortedNews } from '../../utils/getSortedNews';
import { FACEBOOK, INSTAGRAM, LINKEDIN } from '../../consts';
import { text } from '../../content/text/sv/index';

const lang = getTranslations(Astro.url.pathname);
const events = await getSortedEvents(lang);
const news = await getSortedNews(lang);

---

<!doctype html>
<Body>
    <div>
        <img class="m-0 p-0 w-full rounded-none" src="/images/index2.png" alt="Picture of D-chip" /> 
    </div>
    <main class="p-0">
        <!-- Two Column Section -->
        <div class="content-container">
            <div class="text-column">
                <div class="container h-full">
                    <h2>{text.welcomeTitle}</h2>
                    <div class="divider"></div>
                    <p>{text.welcomeText}<br><br><b>{text.welcomeInfo}</b></p>
                </div>
            </div>
            <div class="social-column">
                    <div class="container">
					<h4>{text.ideaTitle}</h4>
                    <div class="divider"></div>
					<p class="pb-6">{text.ideaText}</p>
					<a href={`/${lang}/contact`} class="contact-button">{text.contactButton}</a>
				</div>
                <h4>{text.followUs}</h4>
                <div class="divider"></div>
                <div class="social-links">
					<a href={FACEBOOK} target="_blank" class="social-icon facebook-icon">
						<span class="sr-only">Follow us on Facebook</span>
						<svg fill="#ffcfddff" width="40px" height="40px" viewBox="0 0 24 24" id="facebook" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color"><path id="primary" d="M14,6h3a1,1,0,0,0,1-1V3a1,1,0,0,0-1-1H14A5,5,0,0,0,9,7v3H7a1,1,0,0,0-1,1v2a1,1,0,0,0,1,1H9v7a1,1,0,0,0,1,1h2a1,1,0,0,0,1-1V14h2.22a1,1,0,0,0,1-.76l.5-2a1,1,0,0,0-1-1.24H13V7A1,1,0,0,1,14,6Z" style="fill: #ffcfddff;"></path></svg>
						</svg>
					</a>
					
					<a href={INSTAGRAM} target="_blank" class="social-icon instagram-icon">
						<span class="sr-only">Follow us on Instagram</span>
						<svg fill="#ffcfddff" width="35px" height="35px" viewBox="-2 -2 24 24" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin" class="jam jam-instagram"><path d='M14.017 0h-8.07A5.954 5.954 0 0 0 0 5.948v8.07a5.954 5.954 0 0 0 5.948 5.947h8.07a5.954 5.954 0 0 0 5.947-5.948v-8.07A5.954 5.954 0 0 0 14.017 0zm3.94 14.017a3.94 3.94 0 0 1-3.94 3.94h-8.07a3.94 3.94 0 0 1-3.939-3.94v-8.07a3.94 3.94 0 0 1 3.94-3.939h8.07a3.94 3.94 0 0 1 3.939 3.94v8.07z'/><path d='M9.982 4.819A5.17 5.17 0 0 0 4.82 9.982a5.17 5.17 0 0 0 5.163 5.164 5.17 5.17 0 0 0 5.164-5.164A5.17 5.17 0 0 0 9.982 4.82zm0 8.319a3.155 3.155 0 1 1 0-6.31 3.155 3.155 0 0 1 0 6.31z'/><circle cx='15.156' cy='4.858' r='1.237'/></svg>
					</a>
					
					<a href={LINKEDIN} target="_blank" class="social-icon linkedin-icon">
						<span class="sr-only">Follow us on LinkedIn</span>
						<svg fill="#ffcfddff" width="35px" height="35px" viewBox="-2 -2 24 24" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin" class="jam jam-linkedin"><path d='M19.959 11.719v7.379h-4.278v-6.885c0-1.73-.619-2.91-2.167-2.91-1.182 0-1.886.796-2.195 1.565-.113.275-.142.658-.142 1.043v7.187h-4.28s.058-11.66 0-12.869h4.28v1.824l-.028.042h.028v-.042c.568-.875 1.583-2.126 3.856-2.126 2.815 0 4.926 1.84 4.926 5.792zM2.421.026C.958.026 0 .986 0 2.249c0 1.235.93 2.224 2.365 2.224h.028c1.493 0 2.42-.989 2.42-2.224C4.787.986 3.887.026 2.422.026zM.254 19.098h4.278V6.229H.254v12.869z' /></svg>
					</a>
				  </div>
            </div>
        </div>

        <!-- NEW: Instagram & Latest News Section -->
        <div class="content-container mb-[30px] items-stretch">
            <!-- Instagram Feed Column -->
            <div class="instagram-column flex flex-col flex-1">
                <iframe src={`${INSTAGRAM}/embed`} class="w-full flex-1 min-h-[400px]" frameborder="0" scrolling="no" allowtransparency="true"></iframe>
            </div>

            <!-- Latest News Column -->
            <div class="news-column flex-1">
                <div class="container flex flex-col h-full">
                    <h2 class="news-header">{text.latestNews}</h2>
                    <div class="divider"></div>
                    <ul class="news-list">
                        {
                            news.slice(0, 3).map((post) => (
                                <li class="news-post">
                                    <a href={`/${lang}/news/${post.slug}/`}>
                                        <h4 class="m-0">{post.data.title}</h4>
                                        <p class="text-md text-[#484647] text-center">
                                            Publicerat <FormattedDateNews date={post.data.date} />
                                        </p>
                                    </a>
                                </li>
                            ))
                        }
                    </ul>
                    <a href={`/${lang}/news`} class="contact-button mt-auto self-center">{text.newsButton}</a>
                </div>
            </div>
        </div>
    <div class="container">
        <h2>{text.upcomingEvents}</h2>
        <div class="divider"></div>
            <ul class="blog-posts"> {
                events.map((post) => (
                    <li class="blog-post">
                        <a href={`/${lang}/events/${post.slug}/`}>
                            <img class="circular-image" src={post.data.heroImage} alt="" />
                            <h4 class="title m-0">{post.data.title}</h4>
                            <p class="text-md text-[#484647] text-center">
                                <FormattedDate date={post.data.date} />
                            </p>
                        </a>
                    </li>
                ))
            }
        </ul>
    </div>
    </main>
</Body>
</html>

<style>
    .content-container {
        padding: 1.5em 0 0;
        display: flex;
        justify-content: space-between;
        gap: 1.5em;
    }

	.text-column {
		flex: 2;
	}

	.social-column, .instagram-column, .news-column {
		flex: 1; /* Both columns take equal space */
	}

    /* nedan är till för att göra titlarna jämnhöga */
    .text-column h2, .social-column h4 {
        min-height: 70px;
        display: flex;
        flex-direction: column;
        justify-content: flex-end;
    }

    iframe {
        width: 100%;
        border: none;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Optional shadow */
        border-radius: 8px; /* Optional: round the corners */
    }

    .news-list li {
        margin-bottom: 1.5em;
    }

    .news-post {
        transition: background-color 0.3s ease; /* Smooth transition for hover effect */
    }

    .news-post:hover {
        background-color: rgba(255, 255, 255, 0.25); /* Change background color on hover */
    }

    .blog-posts {
        display: grid; /* Use CSS Grid for layout */
        grid-template-columns: repeat(3, 1fr); /* Three columns */
        list-style-type: none; /* Remove default list styling */
    }

    .blog-post {
        border-radius: 30px; /* Optional: round corners */
        transition: background-color 0.3s ease; /* Smooth transition for hover effect */
    }

    .blog-post:hover {
        background-color: rgba(255, 255, 255, 0.25); /* Change background color on hover */
    }

    .social-links {
		display: flex;
		justify-content: center;
		gap: 1em;
		margin-top: 1em;
	}
	.social-links a {
		text-decoration: none;
		color: rgb(var(--gray));
	}
	.social-links a:hover {
		color: rgb(var(--gray-dark));
	}

    .social-icon {            
        width: 50px;                       /* Adjust the width of the round background */
        height: 50px;                      /* Adjust the height of the round background */
    }

    /* Responsive design for mobile screens (up to 768px wide) */
    @media (max-width: 768px) {
        /* Stack elements vertically */
        .content-container, .news-container {
            flex-direction: column;
            gap: 1.5em; /* Adds space between stacked items */
        }
        /* Reduce the size of circular images */
        .circular-image {
            width: 150px;
            height: 150px;
        }

        /* Make blog posts grid stack into a single column */
        .blog-posts {
            grid-template-columns: 1fr;
            gap: 1em; /* Adds space between each post */
        }

        /* Adjust button and text sizes for mobile readability */
        .contact-button {
            font-size: 0.9em;
        }

    }
</style>